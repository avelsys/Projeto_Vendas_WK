unit Vendas.Model.BaseCadastro;

interface

uses
  System.Generics.Collections, Vcl.ActnList, Vcl.ComCtrls, Vcl.Forms, Data.DB;

type
  TTipoAcao      = (taBrowse, taNovo, taEditar, taExcluir, taGravar, taCancelar, taSair);
  TArrayAcao     = Set of TTipoAcao;

const
  csTipoAcaoDescricao: array[TTipoAcao] of String = ('Listagem','Novo', 'Editar',
                                                    'Excluir','Gravar','Cancelar','Sair');


  csVizualizacao = [taBrowse,  taExcluir, taGravar, taCancelar];
  csEdicao       = [taNovo, taEditar, taExcluir];
  csModEdicao    = [taBrowse, taGravar, taExcluir, taCancelar];
  csModPersisten = [taNovo, taEditar];

type
  TDicionarioAcoes           = TDictionary<TTipoAcao,TAction>;
  TDicionarioTabSheets       = TDictionary<TArrayAcao,TTabSheet>;
  TDicionarioDataSource      = TDictionary<string,TDataSource>;
  TDicionarioControle        = TDictionary<Tframe,TDataSource>;

  TDadosFrame = record
    Acao: TTipoAcao;
    Tabela: string;
    Campo: string;
    TipoDado: TFieldType;
    Valor: Variant;
  end;

  TDadosLista        = TList<TDadosFrame>;
  TDadosColecao      = TDictionary<variant,TDadosLista>;
  TNumericFieldClass = class of TField;


  iModelBaseCadastro         = interface;
  TRotinaGravaAutomatico     = reference to function: iModelBaseCadastro;

  iModelBaseCadastro = interface
    ['{AD0F9E33-AE8B-4E76-A8F0-6DFFAF390D3C}']
    /// <summary>
    ///   Função que inicia uma ação do tipo TTipoAcao.
    /// </summary>
    /// <param name="AAcao">
    ///   Parâmetro que instância uma ação no CRUD do tipo: taNovo, taEditar, taExcluir...
    /// </param>
    function IniciarAcao(const AAcao: TTipoAcao): iModelBaseCadastro;
    /// <summary>
    ///   Set a função para gravar automaticamente os dados
    /// </summary>
    /// <param name="AProcedimento">
    ///   Rotina para controle da função gravar
    /// </param>
    function SetGravaAutomatico(AProcedimento: TRotinaGravaAutomatico):iModelBaseCadastro;
    /// <summary>
    ///   Captura a função de gravação
    /// </summary>
    function GetGravaAutomatico: TRotinaGravaAutomatico;
    /// <summary>
    ///   Captura o DataSource principal da tela
    /// </summary>
    function PegarDataSourcePrincpal: TDataSource;
    function PegarColecaoDados: TDadosColecao;
  end;

implementation

end.
